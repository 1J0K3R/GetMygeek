@page "/"
@using GetMygeek.Models
@rendermode InteractiveServer

<PageTitle>GetMyGeek</PageTitle>

<div Style="@isInResearch" Class="d-flex justify-center" Elevation="0">
    <div Class="d-flex flex-column gap-4 align-self-center">
        <div Class="d-flex justify-center gap-4 align-self-center">
            <MudInput 
                Placeholder="Rechercher un consultant" 
                Type="string" 
                @bind-Value="researchQuery.input" 
                style="width:350px; height:50px;"
                Variant="Variant.Outlined" 
                Class="align-self-center"/>

            <MudButton 
                Variant="Variant.Filled" 
                Color="Color.Dark" 
                Style="height:50px; width:180px"
                EndIcon="@Icons.Material.Filled.PersonSearch" 
                @onclick="() => onClickRechercher()">Rechercher</MudButton>
        </div>

        <div Class="d-flex justify-center gap-4 align-self-center" Style="max-width: 1000px;">
            <MudSelect 
                @bind-Value="researchQuery.available" 
                Label="Disponibilite" 
                Variant="Variant.Outlined" 
                Style="width:250px;">

                <MudSelectItem Value="@("disponible")">
                    <MudIcon Icon="@Icons.Material.Filled.Check" height="14" class="mr-1" /> Disponible
                </MudSelectItem>

                <MudSelectItem Value="@("en mission")">
                    <MudIcon Icon="@Icons.Material.Filled.Cancel" height="14" class="mr-1" /> En mission
                </MudSelectItem>
            </MudSelect>  

            <MudTextField @bind-Value="researchQuery.anciennete" Label="Anciennete minimale" Variant="Variant.Outlined" Style="width:250px"/> 

            <MudSelect T="string" Label="Mission recherchee" Variant="Variant.Outlined" MultiSelection="true" @bind-Value="value" @bind-SelectedValues="researchQuery.profilesSelected" Style="width:250px;">
                @foreach (var profile in profiles)
                {
                    <MudSelectItem T="string" Value="@profile">@profile</MudSelectItem>
                }
            </MudSelect>

        </div>
    </div>  
</div>

@if (researchQuery.IsImplement())
    {
        <Phototèque ResearchQuery = "@researchQuery" />
    }
    else
    {
        <MudText>Chargement des données...</MudText>
    }





@code {

    private ResearchQuery researchQuery = new();
    private string isInResearch { get; set; } = "height: 90vh;";
    private string[] profiles = { "Dev", "Fonctionnel", "Infrastructures" };
    private string value { get; set; } = "Nothing selected";


    private void onClickRechercher()
    {
        if (string.IsNullOrEmpty(researchQuery.input))
        {
            researchQuery.input = "";
        }
        isInResearch = "height: 25vh;";
        StateHasChanged();
    }
}